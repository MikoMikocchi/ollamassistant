# Ollamassistant

Локальный ассистент на базе Ollama для браузера (overlay + контекстное меню + стрим), реализованный как Svelte/Vite проект с отдельным Chrome MV3 расширением.

## Кратко

Проект предоставляет overlay-интерфейс и background-слой в виде Chrome Extension (MV3), который общается с локальным экземпляром Ollama (на 127.0.0.1:11434). Вся сетевой активность ограничена локальной машиной — проект спроектирован без внешнего трафика.

## Структура репозитория

- `extension/` — исходники Chrome MV3 расширения (service worker, content script, UI overlay на Svelte в `ui/`).
- `public/` — публичные ассеты для UI/витрины.
- `package.json` — корневые скрипты для локальной разработки и сборки расширения.
- `tsconfig.json`, настройки TypeScript и Svelte.

Основные файлы расширения:

- `extension/manifest.json` — манифест расширения (host permissions, команды, контент-скрипты).
- `extension/src/background.ts` — service worker фоновая логика.
- `extension/src/content.ts` — content script, который внедряет overlay.
- `extension/ui/Overlay.svelte` — UI overlay.

## Предварительные требования

- Node.js (рекомендуется 18+)
- npm
- Локально запущенный Ollama, доступный по http://127.0.0.1:11434 (или на 127.0.0.1/localhost на порту 11434)

Примечание: расширение использует host permissions только для localhost/127.0.0.1 адресов (см. `extension/manifest.json`).

## Установка и быстрая проверка

1. Клонируйте репозиторий и перейдите в каталог проекта.
2. Установите зависимости (при необходимости):

```bash
npm install
```

3. Убедитесь, что Ollama запущен локально и отвечает на http://127.0.0.1:11434

## Команды разработки

- Запуск Vite дев-сервера (если проект использует UI вне расширения):

```bash
npm run dev
```

- Проверки (svelte-check + tsc):

```bash
npm run check
```

- Запуск development режима для расширения:

```bash
npm run dev:ext
```

- Сборка расширения для продакшена:

```bash
npm run build:ext
```

После сборки расширения директория с готовым артефактом: `extension/dist` — её можно загрузить в Chrome/Chromium как "Load unpacked" (chrome://extensions → Developer mode → Load unpacked → выбрать `extension/dist`).

## Архитектура и как это работает

- Background (service worker): отвечает за контекстное меню, взаимодействие с API Ollama и управление состоянием, которое должно жить вне контента страницы.
- Content script: внедряется на все страницы (`<all_urls>`) и отвечает за встраивание overlay-интерфейса на страницу и передачу сообщений между UI и фоновым сервисом.
- UI (Svelte): отображает overlay, принимает ввод от пользователя и стримит/отображает ответы от Ollama.
- Host permissions ограничены локалхостом, чтобы предотвратить внешние запросы.

## Безопасность и приватность

- Расширение специально настроено для работы с локальным экземпляром Ollama — никакой внешней сетевой активности не требуется и не подразумевается.
- Тем не менее в манифесте есть разрешения на работу с `http://127.0.0.1/*` и `http://localhost/*` — убедитесь, что на системе запускается доверенный локальный сервис.

## Отладка и советы

- Откройте chrome://extensions → включите Developer mode → Load unpacked → выберите `extension/dist` после сборки.
- Для просмотра логов фона откройте "Service worker" → "Inspect views" в странице расширений.
- Для отладки content script используйте DevTools страницы, на которой внедрён overlay.

## Вклад и развитие

Если хотите добавить функции или улучшения — создавайте pull requests. В описании PR указывайте:

- краткое описание изменения;
- как протестировать локально;
- потенциальные риски для приватности/безопасности.